#summary Описание API сервиса

= Обзор =

API сервиса www.4konverta.com построено на основе принципов REST. На этой страничке я привел адреса страниц API и какие операции с ними возможно. 

В описании в фигурных скобках описаны параметры, которые нужно подставлять в адреса. 
Возможны следующие параметры:
|| Название || Описание ||
|| user || Логин пользователя ||
|| date || Дата в формате yyyy-MM-dd ||
|| personId || Идентификатор члена семьи, возвращается в /data/{user} ||
|| envelopeBegin || Дата начала недели. Если на указанной дате неделя не начинается, буде выбран конверт, в который входит указанная дата. ||

<br>
= Авторизация =

Для авторизации с каждым запросом нужно передавать два заголовка.
|| 4KApplication || Идентификатор стороннего приложения. <br> Раздается авторами сервиса "4 конверта" <br> Для тестов можно использовать значение Demo ||
|| 4KAuth || Пароль пользователя ||

Если авторизация неверна, будет возращен код ошибки 401.

<br>
= Версионность =

Для указания версии используется заголовок 4KVersion. Клиент может опускать этот заголовок, в таком случае будет использована последняя версия API. Формат версии - число с плавающей точкой.

<br>
= Описание API =

*URL*: /data/{user} <br>
Доступные действия: GET <br>
Результат: 
{{{
<user>
  <country>Великобритания</country>
  <currencyLongName>фунт стерлингов</currencyLongName>
  <currency>фунт</currency>
  <countryCode>gb</country>
  <currencyCode>GBP</currencyCode>
  <firstDayOfWeek>1</firstDayOfWeek> <!-- 0 - sunday, 1 - monday -->
  <timeZone>Europe/London</timeZone>

  <persons>
    <person id="23443234" name="Петя"/>
    <person>...</person>
  </persons>
</user>
}}}

*URL*: /data/{user}/envelope/{envelopeBegin} <br>
Доступные действия: GET <br>
Результат: 
{{{
<envelope begin="yyyy-MM-dd" size="1005.0">
  <person id="23443234" name="Петя">
    <dailyExpense date="yyyy-MM-dd">
      <expression>150 кафе, 20 еда</expression>
      <sum>170.0</sum>
    </dailyExpense>
    ...
  </person>
  ...
</envelope>
}}}

*URL*: /data/{user}/dailyExpense/{personId}/{date} <br>
Доступные действия: GET, POST <br>
Результат: 
{{{
<dailyExpense date="yyyy-MM-dd">
  <expression>150 кафе, 20 еда</expression>
  <sum>170.0</sum>
</dailyExpense>
}}}

POST служит для задания ежедневных трат. При этом в теле запроса отсылается выражение для траты, например, <br> expression=150 кафе, 20 еда (URL-encoded UTF-8)