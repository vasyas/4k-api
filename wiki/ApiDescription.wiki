#summary Описание API сервиса

= Обзор =

API сервиса www.4konverta.com построено на основе принципов REST. На этой страничке я привел адреса страниц API и какие операции с ними возможно. 

В описании в фигурных скобках описаны параметры, которые нужно подставлять в адреса. 
Возможны следующие параметры:
|| Название || Описание ||
|| user || Логин пользователя ||
|| date || Дата в формате yyyy-MM-dd ||
|| personId || Идентификатор члена семьи, возвращается в /data/{user} ||
|| envelopeDay || День недели относительно начала конверта, 0 - первый день, 1 - второй ||

<br>
= Авторизация =

Для авторизации с каждым запросом нужно передавать два заголовка.
|| 4KApplication || Идентификатор стороннего приложения. <br> Раздаем авторами сервиса "4 конверта"  ||
|| 4KAuth || Пароль пользователя ||

Если авторизация неверна, будет возращен код ошибки 401.

<br>
= Версионность =

Для указания версии используется заголовок 4KVersion. Клиент может опускать этот заголовок, в таком случае будет использована последняя версия API. Формат версии - число с плавающей точкой.

<br>
= Описание API =

*URL*: /data/{user} <br>
Доступные действия: GET <br>
Результат: 
{{{
<user>
  <country>Великобритания</country>
  <currencyLongName>фунт стерлингов</currencyLongName>
  <currency>фунт</currency>
  <countryCode>gb</country>
  <currencyCode>GBP</currencyCode>
  <firstDayOfWeek>1</firstDayOfWeek> <!-- 0 - sunday, 1 - monday -->
  <timeZone>Europe/London</timeZone>

  <persons>
    <person>
      <id>23443234</id>
      <name>Петя</name>
    </person>
    <person>...</person>
  </persons>
</user>
}}}

*URL*: /data/{user}/envelope/{date} <br>
Доступные действия: GET, POST <br>
Результат: 
{{{
<envelope>
  <date>yyyy-MM-dd</date>
  <size>1005</size>
  <daily>143.5</daily>
  <spent>21</spent>
  <left>984</left>

  <dailyExpenses>
    <dailyExpense> <!-- Для всех дней и всех пользователей -->
      <day>0</day>
      <personId>23443234</personId>
      <expression>150 кафе, 20 еда</expression>
      <sum>170.0</sum>
    </dailyExpense>
  </dailyExpenses>
</envelope>
}}}
POST служит для задания ежедневных трат. При этом в теле запроса отсылаются envelopeDate, personId и expression, например, <br> envelopeDay=0&personId=23443234&expression=150 кафе, 20 еда (URL-encoded UTF-8, конечно)